---
title: "Global Sea Level Rise"
author: "Maximilian Stock"
date: "11/26/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(readxl)
library(tidyverse)
library(janitor)
library(lubridate)
```

```{r}
months <- c("January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December")

NorthernHem <- list()
SouthernHem <- list()

for (i in months) {
  NorthernHem[[i]] <- read_excel("Sea_Ice_Index_Monthly_Data_with_Statistics_G02135_v3.0.xlsx",
    sheet = paste0(i,"-NH"), skip = 8, range = "B10:S53")
}

for (i in months) {
  SouthernHem[[i]] <- read_excel("Sea_Ice_Index_Monthly_Data_with_Statistics_G02135_v3.0.xlsx",
    sheet = paste0(i,"-SH"), skip = 8, range = "B10:S53")
}

bindedNH <- bind_rows(NorthernHem)
bindedSH <- bind_rows(SouthernHem)

master <- bind_rows(bindedNH, bindedSH) %>% 
  clean_names()

```

```{r}
sheets <- c("Land", "Population", "GDP", "Agriculture", "UrbanExtent")

for (i in sheets) {
  assign(paste0("imp", i), read_excel("new_slr-impacts_nov2010.xls", 
    sheet = i))
}

impAgriculture <- impAgriculture %>% 
  clean_names()

```

```{r}
tempAnomaliesNH <- read_excel("tempAno.xlsx", sheet = "Sheet1", col_types = c("numeric", 
    "numeric")) %>% 
  clean_names()

tempAnomaliesSH <-read_excel("tempAno.xlsx", sheet = "Sheet2", col_types = c("numeric", 
    "numeric")) %>% 
  clean_names()

tempAnomaliesGlobal <- left_join(tempAnomaliesNH, tempAnomaliesSH, by = "year_jan")
tempAnomaliesGlobal <- tempAnomaliesGlobal %>% 
  pivot_longer(cols = c("nh_value_celsius", "sh_value_celsius"), values_to = "tempAnomaly")
```

```{r}

master <- master %>% 
  mutate(date = make_date(year, month))

yearlyIceMeans <- master %>% 
  select(-reordered) %>% 
  drop_na() %>% 
  group_by(year, hemisphere) %>% 
  summarise(meanEx = mean(extent), meanAno = mean(extent_anomaly), fill = if_else(meanAno >= 0, "a", "b")) %>% 
  ggplot(aes(x = year)) +
    geom_line(aes(y = meanEx, color = hemisphere))+
    geom_col(aes(y = meanAno*20, fill = fill, )) +
    scale_y_continuous(
    
    # Features of the first axis
    name = "First Axis",
    
    # Add a second axis and specify its features
    sec.axis = sec_axis(~.*1/20, name="Second Axis")
  )

yearlyIceMeans

```

```{r}



```

